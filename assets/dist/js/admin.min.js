jQuery.stripslashes=function(t){return""==t?t:t=(t=(t=(t=(t=t.replace(/\\'/g,"'")).replace(/\\"/g,'"')).replace(/\\/g,"")).replace(/\\\\/g,"\\")).replace(/\\0/g,"\0")},jQuery(document).ready(function(t){var e,a=a||window.tinymce,i=t("#simpledoc_list"),l=t("#smpldoc_editor"),d=t("#smpldoc_input"),n=t("#smpldoc_file"),o=t("#sd_list"),s=t("#sd_add"),c=t("#swtch_btn"),r="list",p=t("#sd_import_button"),_=t("#sd_import"),m=t("#sd_export_button"),f=t("#sd_export_options"),u=t("#sd_export");function v(){var e;s.fadeOut(function(){o.fadeIn(),r="list",c.html(ajax_object.add_new)}),(e=a.get("smpldoc_item_content"))?e.setContent(""):t("#smpldoc_item_content").val(""),t("#smpldoc_item_title").val(""),t("#item_type").val("nope"),t("#smpldoc_item_link").val(""),t("#smpldoc_item_file").val(""),t(".smpldoc_item_users").removeAttr("checked"),t("#sd_add").find("ul.add_list").find("li").removeClass("smpldoc_active").removeClass("smpldoc_disabled")}function h(e,i){t("#item_type").val(e);var o="",s=0,c="",r="",p="";if(t("#smpldoc_additem").attr("data-action","add").text(ajax_object.add_item),void 0!==i&&(p=i.title,o=i.content,s=i.attachment_id,c=i.attachment_url,r=i.attachment_filename,t("#item_id").val(i.ID),t(".add_list").find("li").addClass("smpldoc_disabled"),t("#smdoc_"+i.type+"_cat").parent("li").removeClass("smpldoc_disabled").addClass("smpldoc_active"),t("#smpldoc_additem").attr("data-action","edit").text(ajax_object.save_changes),i.restricted&&t(".smpldoc_item_users").each(function(){var e=t(this);-1!==i.restricted.indexOf(e.val())&&e.attr("checked","")})),t("#smpldoc_item_title").val(p),"note"==e||"video"==e){d.fadeOut(200).val(""),n.fadeOut(200).val("");var _=a.get("smpldoc_item_content");_?_.setContent(o):t("#smpldoc_item_content").val(o),l.delay(200).fadeIn(100)}else"file"==e?(d.fadeOut(200).val(""),l.fadeOut(200).val(""),t("#smpldoc_item_file").val(s),n.delay(200).fadeIn(100),c&&r?t("#smpldoc_filename").html('<a href="'+c+'">'+(r||"")+"</a>"):t("#smpldoc_filename").html("")):"link"==e&&(l.fadeOut(200).val(""),n.fadeOut(200).val(""),t("#smpldoc_item_link").val(o),d.delay(200).fadeIn(100))}function j(t){for(var e=ajax_object.fields_missing+"\n",a=0;a<t.length;a++)a>1&&(e+=", "),e+=t[a];alert(e)}function y(e){var a,i=t.parseJSON(e);if("user-error"==i.status)"empty_fields"==i.type&&j(i.data);else if("ok"==i.status)if("delete"==i.type)t("#simpledoc_"+i.id).fadeOut(500);else if("get-data"==i.type)a=i.data,"list"===r&&(h(a.type,a),o.fadeOut(function(){s.fadeIn(),r="add",c.html(ajax_object.view_list)}),t("#smpldoc_overlay").fadeOut(300));else if("edit"==i.type){var l=t("#simpledoc_"+i.data.id);l.find(".el_title").html(i.data.title),d="link"==i.data.type?'<a href="'+i.data.content+'">'+i.data.content+"</a>":"file"==i.data.type?'<a href="'+i.data.attachment_url+'">'+i.data.attachment_url+"</a>":i.data.content,l.find(".el_expand").html(d),l.find(".smpldoc_usersallowed").attr("title",i.data.users.join(", ")),v()}else if("add"==i.type){var d,n=t("<span />").attr("class","el_front_bf").html('<a href="#" class="smpldoc_sort"><i class="fa fa-bars"></i></a> <i class="fa fa-'+function(t){switch(t){case"video":return"youtube-play";case"link":return"link";case"file":return"files-o";default:return"comments"}}(i.data.type)+'"></i>'),p=t("<span />").attr("class","el_front_af").html('<i class="fa fa-user"></i> <a href="#edit" class="smpldoc_edit_item"><i class="fa fa-pencil"></i></a> <a href="#delete" class="smpldoc_delete_item"><i class="fa fa-times"></i></a></span>'),_=t("<span />").attr("class","el_title").html(t.stripslashes(i.data.title));d="file"==i.data.type?'<a href="'+i.data.attachment_url+'">'+i.data.attachment_url+"</a>":"link"==i.data.type?'<a href="'+i.data.content+'">'+i.data.content+"</a>":i.data.content;var m=t("<div />").attr("class","el_expand").html(t.stripslashes(d)),f=t("<div />").attr("class","el_front").attr("data-id",i.data.id).append(n).append(_).append(p),u=t("<li />").attr("id","simpledoc_"+i.data.id).append(f).append(m);t("#simpledoc_list").append(u),v()}else if("reorder"==i.type){var y=t("<div />").attr("class","updated smpldoc_notif").html("<p>"+ajax_object.order_saved+" !</p>").delay("1500").fadeOut(700,function(){t(".smpldoc_notif").remove()});t(".wrap").prepend(y)}}i.on("click","li",function(e){var a=t(this);t(".hover").each(function(){var e=t(this);e.attr("id")!=a.attr("id")&&t(".hover").find(".el_expand").animate({height:"toggle",paddingTop:"toggle",paddingBottom:"toggle"},300,function(){e.removeClass("hover")})}),a.find(".el_expand").animate({height:"toggle",paddingTop:"toggle",paddingBottom:"toggle"},700),setTimeout(function(){a.hasClass("hover")?a.removeClass("hover"):a.addClass("hover")},0)}),c.on("click",function(t){t.preventDefault(),"list"===r?o.fadeOut(function(){s.fadeIn(),r="add",c.html(ajax_object.view_list)}):v()}),t("#sd_add").find("ul.add_list").on("click","a",function(e){e.preventDefault();var a=t(this),i=a.attr("data-type");t("#sd_add").find("ul.add_list").find("li").removeClass("smpldoc_active").addClass("smpldoc_disabled"),a.parent("li").addClass("smpldoc_active"),h(i),t("#smpldoc_overlay").fadeOut(300)}),t(".cd_button_upload").on("click",function(a){var i=t("#smpldoc_item_file"),l=t("#smpldoc_filename");if(a.preventDefault(),!e)return(e=wp.media.frames.file_frame=wp.media({title:t(this).data("uploader_title"),button:{text:t(this).data("uploader_button_text")},multiple:!1})).on("select",function(){var t=e.state().get("selection").first().toJSON();i.attr("value",t.id),l.html(t.filename)}),e.open(),!1;e.open()}),t("#smpldoc_additem").on("click",function(e){e.preventDefault();var i=[],l=[],d="add",n="";t(".smpldoc_item_users").each(function(){t(this).is(":checked")&&i.push(t(this).val())});var o=a.get("smpldoc_item_content");n=o?o.getContent():t("#smpldoc_item_content").val();var s={title:t("#smpldoc_item_title").val(),type:t("#item_type").val(),input:t("#smpldoc_item_link").val(),file:t("#smpldoc_item_file").val(),editor:n,user_roles:i};if("nope"==s.type&&l.push("type"),s.title.length<1&&l.push("title"),"note"!=s.type&&"video"!=s.type||!s.editor||l.push("content"),"link"==s.type&&s.input.length<1&&l.push("link"),"file"==s.type&&"nope"==s.file&&l.push("file"),l.length>1)return j(l),!1;"edit"==t(this).attr("data-action")&&(d="edit",s.id=t("#item_id").val());var c={action:"simpleDocumentation_ajax",a:d,item:s};jQuery.post(ajax_object.ajax_url,c,function(t){y(t)})}),t("#simpledoc_list").on("click",".smpldoc_delete_item",function(e){e.preventDefault();var a={action:"simpleDocumentation_ajax",a:"delete",id:t(this).parent().parent().attr("data-id")};jQuery.post(ajax_object.ajax_url,a,function(t){y(t)})}),t("#simpledoc_list").sortable({containment:"parent",axis:"y",handle:".smpldoc_sort",opacity:.6,update:function(){var e=[];t("#simpledoc_list").find("li").each(function(){e.push(t(this).find(".el_front").attr("data-id"))});var a={action:"simpleDocumentation_ajax",a:"reorder",data:e};jQuery.post(ajax_object.ajax_url,a,function(t){y(t)})}}),t("#simpledoc_list").on("click",".smpldoc_edit_item",function(e){e.preventDefault();var a={action:"simpleDocumentation_ajax",a:"get-data",id:t(this).parent().parent().attr("data-id")};jQuery.post(ajax_object.ajax_url,a,function(t){y(t)})}),m.on("click",function(t){t.preventDefault(),u.val(ajax_object.loading+"...");var e={action:"simpleDocumentation_ajax",a:"export",options:f.attr("checked")?"include":"exclude"};jQuery.post(ajax_object.ajax_url,e,function(t){u.val(t).removeAttr("disabled").removeClass("disabled")})}),p.on("click",function(e){e.preventDefault();var a={action:"simpleDocumentation_ajax",a:"import",data:t.parseJSON(_.val())};_.val(ajax_object.processing+"..."),jQuery.post(ajax_object.ajax_url,a,function(e){"ok"==t.parseJSON(e).status?_.val(ajax_object.label_done):_.val(ajax_object.error)})})});